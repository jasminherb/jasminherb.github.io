---
layout: single
title:  "Excel Macro & VBA "
---


#### 출처 : ChatGPT

#### "data" 폴더안에 있는 CSV 파일들을 "result.xlsx"라는 Exel의 각 탭별로 분리하여 저장

```vba
Sub SplitCSVFilesToTabs()
    Dim dataFolder As String
    Dim resultFile As String
    Dim csvFiles As Variant
    Dim csvFile As Variant
    Dim tabName As String
    Dim wb As Workbook
    Dim ws As Worksheet
    Dim rng As Range
    Dim row As Long
    Dim col As Long
    
    ' data 폴더 경로
    dataFolder = "C:\Path\To\data"
    
    ' 결과 파일 경로
    resultFile = "C:\Path\To\result.xlsx"
    
    ' 결과 엑셀 파일 생성
    Set wb = Workbooks.Add
    
    ' data 폴더 내의 CSV 파일 목록 조회
    csvFiles = GetCSVFiles(dataFolder)
    
    ' 각 CSV 파일을 엑셀의 탭으로 분리하여 저장
    For Each csvFile In csvFiles
        ' 탭 이름으로 사용할 파일명 추출
        tabName = Left(csvFile, Len(csvFile) - 4)
        
        ' CSV 파일을 엑셀의 탭으로 추가
        Set ws = wb.Sheets.Add(After:=wb.Sheets(wb.Sheets.Count))
        ws.Name = tabName
        
        ' CSV 파일 내용을 탭에 복사
        With ws.QueryTables.Add(Connection:="TEXT;" & dataFolder & "\" & csvFile, Destination:=ws.Range("A1"))
            .TextFileParseType = xlDelimited
            .TextFileCommaDelimiter = True
            .Refresh
        End With
        
        ' 결과 탭의 컬럼 너비 자동 조정
        Set rng = ws.UsedRange
        rng.Columns.AutoFit
    Next
    
    ' 기본 탭 제거
    Application.DisplayAlerts = False
    wb.Sheets("Sheet1").Delete
    Application.DisplayAlerts = True
    
    ' 결과 엑셀 파일 저장
    wb.SaveAs resultFile
    wb.Close
    
    MsgBox "CSV files have been split and saved to tabs in result.xlsx.", vbInformation
End Sub

Function GetCSVFiles(folderPath As String) As Variant
    Dim csvFiles() As Variant
    Dim file As String
    Dim i As Long
    
    file = Dir(folderPath & "\*.csv")
    
    While file <> ""
        ReDim Preserve csvFiles(i)
        csvFiles(i) = file
        i = i + 1
        file = Dir
    Wend
    
    GetCSVFiles = csvFiles
End Function
```



#### 세 개의 탭에 있는 데이터를 summary 탭의 지정된 열에 복사

첫번째 탭의 o열 p열의 값을 summary 라는 새로운 탭을 만들어 a열 b열에 넣어주고,  
두번째 탭의 o열 p열의 값을 summary 라는 탭에  d열 e열에 넣어주고,
세번째 탭의 o열 p열의 값을 summary 라는 탭에  g열 h열에 넣어주는 액셀 vba 코드

```vba
Sub CopyValuesToSummaryTab()
    Dim ws As Worksheet
    Dim summaryWs As Worksheet
    Dim i As Integer
    Dim lastRow As Long
    
    ' 새로운 summary 탭 생성
    Set summaryWs = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))
    summaryWs.Name = "Summary"
    
    ' 첫번째 탭 데이터 복사
    Set ws = ThisWorkbook.Sheets(1)
    lastRow = ws.Cells(ws.Rows.Count, "O").End(xlUp).Row
    For i = 1 To lastRow
        summaryWs.Cells(i, "A").Value = ws.Cells(i, "O").Value
        summaryWs.Cells(i, "B").Value = ws.Cells(i, "P").Value
    Next i
    
    ' 두번째 탭 데이터 복사
    Set ws = ThisWorkbook.Sheets(2)
    lastRow = ws.Cells(ws.Rows.Count, "O").End(xlUp).Row
    For i = 1 To lastRow
        summaryWs.Cells(i, "D").Value = ws.Cells(i, "O").Value
        summaryWs.Cells(i, "E").Value = ws.Cells(i, "P").Value
    Next i
    
    ' 세번째 탭 데이터 복사
    Set ws = ThisWorkbook.Sheets(3)
    lastRow = ws.Cells(ws.Rows.Count, "O").End(xlUp).Row
    For i = 1 To lastRow
        summaryWs.Cells(i, "G").Value = ws.Cells(i, "O").Value
        summaryWs.Cells(i, "H").Value = ws.Cells(i, "P").Value
    Next i
End Sub

```

