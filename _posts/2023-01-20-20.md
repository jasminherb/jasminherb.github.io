---
layout: single
title:  "Excel Macro & VBA "
---


#### 출처 : ChatGPT

#### "data" 폴더안에 있는 CSV 파일들을 "result.xlsx"라는 Exel의 각 탭별로 분리하여 저장

```

Sub SplitCSVFilesToTabs()
    Dim folderPath As String
    Dim outputFilePath As String
    Dim fileName As String
    Dim tabName As String
    Dim wb As Workbook
    Dim ws As Worksheet
    Dim csvData As Variant
    Dim rowIndex As Long
    Dim columnIndex As Long
    
    ' 데이터 폴더 경로
    folderPath = "D:\data"
    ' 결과 Excel 파일 경로
    outputFilePath = "D:\data\result.xlsx"
    
    ' 새로운 Excel 파일 생성
    Set wb = Workbooks.Add
    
    ' 데이터 폴더 내 CSV 파일 처리
    fileName = Dir(folderPath & "\*.csv")
    Do While fileName <> ""
        ' 탭 이름 (파일명에서 확장자 제거)
        tabName = Left(fileName, Len(fileName) - 4)
        
        ' 새로운 탭 생성
        Set ws = wb.Sheets.Add(After:=wb.Sheets(wb.Sheets.Count))
        ws.Name = tabName
        
        ' CSV 파일 열기
        With ws.QueryTables.Add(Connection:="TEXT;" & folderPath & "\" & fileName, Destination:=ws.Range("A1"))
            .TextFileParseType = xlDelimited
            .TextFileCommaDelimiter = True
            .Refresh
        End With
        
        ' 다음 CSV 파일 처리를 위해 파일명 업데이트
        fileName = Dir
    Loop
    
    ' 결과 Excel 파일 저장
    wb.SaveAs outputFilePath
    wb.Close
    
    MsgBox "분리된 데이터가 저장되었습니다."
End Sub

```



#### 세 개의 탭에 있는 데이터를 summary 탭의 지정된 열에 복사

첫번째 탭의 o열 p열의 값을 summary 라는 새로운 탭을 만들어 a열 b열에 넣어주고,  
두번째 탭의 o열 p열의 값을 summary 라는 탭에  d열 e열에 넣어주고,
세번째 탭의 o열 p열의 값을 summary 라는 탭에  g열 h열에 넣어주는 액셀 vba 코드

```
Sub CopyValuesToSummaryTab()
    Dim ws As Worksheet
    Dim summaryWs As Worksheet
    Dim i As Integer
    Dim lastRow As Long
    
    ' 새로운 summary 탭 생성
    Set summaryWs = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))
    summaryWs.Name = "Summary"
    
    ' 첫번째 탭 데이터 복사
    Set ws = ThisWorkbook.Sheets(1)
    lastRow = ws.Cells(ws.Rows.Count, "O").End(xlUp).Row
    For i = 1 To lastRow
        summaryWs.Cells(i, "A").Value = ws.Cells(i, "O").Value
        summaryWs.Cells(i, "B").Value = ws.Cells(i, "P").Value
    Next i
    
    ' 두번째 탭 데이터 복사
    Set ws = ThisWorkbook.Sheets(2)
    lastRow = ws.Cells(ws.Rows.Count, "O").End(xlUp).Row
    For i = 1 To lastRow
        summaryWs.Cells(i, "D").Value = ws.Cells(i, "O").Value
        summaryWs.Cells(i, "E").Value = ws.Cells(i, "P").Value
    Next i
    
    ' 세번째 탭 데이터 복사
    Set ws = ThisWorkbook.Sheets(3)
    lastRow = ws.Cells(ws.Rows.Count, "O").End(xlUp).Row
    For i = 1 To lastRow
        summaryWs.Cells(i, "G").Value = ws.Cells(i, "O").Value
        summaryWs.Cells(i, "H").Value = ws.Cells(i, "P").Value
    Next i
End Sub

```

