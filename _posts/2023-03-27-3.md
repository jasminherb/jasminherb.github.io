---
layout: single
title:  "비구면 방정식 구현 & Z값 변형에 의한 fitting 게수 산출 "
---


#### 출처 : ChatGPT


![비구면 방정식](https://github.com/jasminherb/jasminherb.github.io/assets/133365586/1fde4be7-6b0c-4947-b400-5c0612fb443c)

![비구면](https://github.com/jasminherb/jasminherb.github.io/assets/133365586/4b146972-f5e1-4329-b9dc-213e8851f52a)


```python
import numpy as np
import matplotlib.pyplot as plt

def calculate_z_coordinate(r, coefficients, k):
    c2 = coefficients[0]
    z = (c2 * r**2) / (1 + np.sqrt(1 - (1 + k) * c2**2 * r**2))

    for i in range(2, len(coefficients), 2):
        ci = coefficients[i]
        z += ci * r**i

    return z

# 입력값 설정
coefficients = [0.01, 0.001, 0.0001,0.0005,0.0008]  # 비구면 계수 (c2, c4, c6, ...)
k = 0.5  # 컨벡스/컨케이브 정도

# 거리 범위 설정
r_values = np.linspace(-1.0, 1.0, 25)

# Z 좌표 계산
z_values = [calculate_z_coordinate(r, coefficients, k) for r in r_values]

# 그래프 그리기
plt.plot(r_values, z_values)
plt.xlabel('r')
plt.ylabel('Z')
plt.title('Asphere Shape')
plt.grid(True)
plt.show()
```


![비구면 fitting](https://github.com/jasminherb/jasminherb.github.io/assets/133365586/382b8020-e2f3-4d6d-981e-477b46b55740)



