---
layout: single
title:  "비구면 방정식 구현 & Z값 변형에 의한 fitting 게수 산출 "
---


#### 출처 : ChatGPT


![비구면 방정식](https://github.com/jasminherb/jasminherb.github.io/assets/133365586/1fde4be7-6b0c-4947-b400-5c0612fb443c)

![비구면](https://github.com/jasminherb/jasminherb.github.io/assets/133365586/4b146972-f5e1-4329-b9dc-213e8851f52a)


```python
import numpy as np
import matplotlib.pyplot as plt

def calculate_z_coordinate(r, coefficients, k):
    c2 = coefficients[0]
    z = (c2 * r**2) / (1 + np.sqrt(1 - (1 + k) * c2**2 * r**2))

    for i in range(2, len(coefficients), 2):
        ci = coefficients[i]
        z += ci * r**i

    return z

# 입력값 설정
coefficients = [0.01, 0.001, 0.0001,0.0005,0.0008]  # 비구면 계수 (c2, c4, c6, ...)
k = 0.5  # 컨벡스/컨케이브 정도

# 거리 범위 설정
r_values = np.linspace(-1.0, 1.0, 25)

# Z 좌표 계산
z_values = [calculate_z_coordinate(r, coefficients, k) for r in r_values]

# 그래프 그리기
plt.plot(r_values, z_values)
plt.xlabel('r')
plt.ylabel('Z')
plt.title('Asphere Shape')
plt.grid(True)
plt.show()
```


![비구면 fitting](https://github.com/jasminherb/jasminherb.github.io/assets/133365586/382b8020-e2f3-4d6d-981e-477b46b55740)


### 순서도

1. 비구면 방정식에서 각 계수값들을 기입하고, x y 값을 각각 25등분하여 Z 값을 구한다.
2. Z 값에서 열변형에 의한 ΔZ 값을 대입해준다.
3. 새로 만들어진 Z 값을 가지고, 비구면 방정식의 계수값들을 fitting 해준다




r-z 좌표계는 원기둥 좌표계라고도 불리며, 3차원 공간에서 한 점을 나타내는 좌표 체계입니다. 
이 좌표 체계는 반지름 r, 수직 방향으로 떨어진 거리 z, 그리고 원기둥의 축을 따라 회전하는 각도 θ로 정의됩니다.

일반적으로, 원기둥 좌표계의 점을 3차원 직교 좌표계로 변환하기 위해 다음과 같은 변환식을 사용할 수 있습니다:

```scss

x = r * cos(θ)
y = r * sin(θ)
z = z
```


여기서 x, y, z는 3차원 직교 좌표계의 각 축을 나타내며, θ는 원기둥 축 주위의 회전 각도입니다.

반대로, 3차원 직교 좌표계의 점을 r-z 좌표계로 변환하기 위해 다음과 같은 변환식을 사용할 수 있습니다

```scss
r = sqrt(x^2 + y^2)
θ = atan2(y, x)
z = z
```
여기서 sqrt는 제곱근을 나타내며, atan2는 아크탄젠트 함수의 역함수로서 주어진 y와 x 값에 대해 적절한 사분면을 고려하여 각도를 계산합니다.

이러한 변환식을 사용하여 3차원 공간에서 r-z 좌표계와 직교 좌표계 간의 변환을 수행할 수 있습니다.
