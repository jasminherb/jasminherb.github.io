---
layout: single
title:  "아이리스 품종 예측하기(8) "
---

# 다중분류

출처 : Thebook.io (모두의 딥러닝)



![iris-g8fc50379d_640](https://github.com/jasminherb/jasminherb.github.io/assets/133365586/dd20737f-94eb-4610-95d1-268879b3517c)



아이리스 품종 예측하기


```python
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense

import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

# 깃허브에 준비된 데이터를 가져옵니다.
!git clone https://github.com/taehojo/data.git

# 아이리스 데이터를 불러옵니다.
df = pd.read_csv('./data/iris3.csv')
```


#### PairPlot으로 상관관계 파악

각 속성별 데이터 분포와 속성 간의 관계를 한눈에 볼 수 있습니다. 

pairplot() 함수 설정 중 hue 옵션은 주어진 데이터 중 어떤 카테고리를 중심으로 그래프를 그릴지 정해 주게 되는데,

품종(species)에 따라 보여지게끔 지정했습니다. 

그래프 각각의 가로축과 세로축은 서로 다른 속성을 나타내며, 

이러한 속성에 따라 품종이 어떻게 분포되는지 알 수 있습니다. 

가운데 대각선 위치에 있는 그림은 가로축과 세로축이 같으므로 단순히 해당 속성에 따라 각 품종들이 어떻게 분포하는지 보여 줍니다. 

이러한 분석을 통해 꽃잎과 꽃받침의 크기와 너비가 품종별로 어떤 차이가 있는지 알 수 있습니다.

```python

import seaborn as sns
import matplotlib.pyplot as plt

sns.pairplot(df, hue='species'); 
plt.show()

```

![pairplot](https://github.com/jasminherb/jasminherb.github.io/assets/133365586/e7d6951d-2796-48f3-b801-c3699b70f7d1)




```python
# 속성을 X, 클래스를 y로 저장합니다.
X = df.iloc[:,0:4]
y = df.iloc[:,4]

# 원-핫 인코딩 처리를 합니다.
y = pd.get_dummies(y)
```
![image](https://github.com/jasminherb/jasminherb.github.io/assets/133365586/5544af2a-5029-487d-9496-a3e604ca31d0)



```python

# 모델 설정
model = Sequential()
model.add(Dense(12, input_dim=4, activation='relu'))
model.add(Dense(8, activation='relu'))
model.add(Dense(3, activation='softmax'))
model.summary()

# 모델 컴파일
model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])


# 모델 실행
history = model.fit(X, y, epochs=50, batch_size=5)

```
